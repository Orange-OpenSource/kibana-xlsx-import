<div class="app-container xlsx-import" ng-controller="xlsxImport" data-ng-init="useTranslation()">

  <kbn-top-nav name="xlsx-import" config="topNavMenu">
      <div class="kuiLocalNav" ng-show="true" data-test-subj="top-nav">
      <!-- Top row -->
      <div class="kuiLocalNavRow">
        <!-- Top left corner slot, e.g. breadcrumbs, title. -->
        <div class="kuiLocalNavRow__section" data-transclude-slot="topLeftCorner"></div>

        <!-- Right-side: menu -->
        <div class="kuiLocalNavRow__section">
          <div class="kuiLocalMenu">
            <!-- ngRepeat: menuItem in kbnTopNav.menuItems --><button class="kuiLocalMenuItem ng-binding ng-scope" ng-repeat="menuItem in kbnTopNav.menuItems" aria-label="Create new watcher" aria-haspopup="true" aria-expanded="false" ng-class="{'kuiLocalMenuItem-isSelected': kbnTopNav.isCurrent(menuItem.key), 'kuiLocalMenuItem-isDisabled': menuItem.disableButton()}" ng-click="kbnTopNav.handleClick(menuItem)" ng-bind="menuItem.label" tooltip="" tooltip-placement="bottom" tooltip-popup-delay="400" tooltip-append-to-body="1" data-test-subj="sentinlNewWatcher">New</button><!-- end ngRepeat: menuItem in kbnTopNav.menuItems --><button class="kuiLocalMenuItem ng-binding ng-scope" ng-repeat="menuItem in kbnTopNav.menuItems" aria-label="About" aria-haspopup="false" aria-expanded="false" ng-class="{'kuiLocalMenuItem-isSelected': kbnTopNav.isCurrent(menuItem.key), 'kuiLocalMenuItem-isDisabled': menuItem.disableButton()}" ng-click="kbnTopNav.handleClick(menuItem)" ng-bind="menuItem.label" tooltip="" tooltip-placement="bottom" tooltip-popup-delay="400" tooltip-append-to-body="1" data-test-subj="sentinlAbout">About</button><!-- end ngRepeat: menuItem in kbnTopNav.menuItems -->

            <!-- Time-picker "menu item" -->
            <div ng-show="timefilter.isAutoRefreshSelectorEnabled || timefilter.isTimeRangeSelectorEnabled" data-shared-timefilter="false" class="kuiLocalMenu ng-hide" data-test-subj="globalTimepicker">
      <button class="kuiLocalMenuItem ng-hide" aria-label="Pause refreshing data" ng-click="toggleRefresh()" ng-show="timefilter.isAutoRefreshSelectorEnabled &amp;&amp; (timefilter.refreshInterval.value > 0)" data-test-subj="globalTimepickerAutoRefreshButton" data-test-subj-state="active">
        <span class="kuiIcon fa-pause" aria-hidden="true" ng-class="timefilter.refreshInterval.pause ? 'fa-play' : 'fa-pause'"></span>
      </button>

      <button class="kuiLocalMenuItem navbar-timepicker-auto-refresh-desc ng-hide" ng-class="{'kuiLocalMenuItem-isSelected': kbnTopNav.isCurrent('interval') }" ng-show="timefilter.isAutoRefreshSelectorEnabled" ng-click="kbnTopNav.toggle('interval')">
        <span ng-show="timefilter.refreshInterval.value === 0">
          <span aria-hidden="true" class="kuiIcon fa-repeat"></span> Auto-refresh
        </span>

        <span ng-show="timefilter.refreshInterval.value > 0" aria-label="Data will refresh every Off" class="ng-binding ng-hide">
          Off
        </span>
      </button>

      <button ng-show="timefilter.isTimeRangeSelectorEnabled" class="kuiLocalMenuItem ng-hide" ng-click="back()" aria-label="Move backward in time">
        <span class="kuiIcon fa-chevron-left" aria-hidden="true" tooltip="Move backward in time"></span>
      </button>

      <button ng-show="timefilter.isTimeRangeSelectorEnabled" data-test-subj="globalTimepickerButton" class="kuiLocalMenuItem navbar-timepicker-time-desc ng-hide" ng-class="{'kuiLocalMenuItem-isSelected': kbnTopNav.isCurrent('filter')}" ng-click="kbnTopNav.toggle('filter')" aria-label="Open time range picker" aria-haspopup="true">
        <span aria-hidden="true" class="kuiIcon fa-clock-o"></span>
        <pretty-duration from="timefilter.time.from" to="timefilter.time.to" data-test-subj="globalTimepickerRange" class="ng-isolate-scope" aria-label="Current time range is Last 15 minutes">Last 15 minutes</pretty-duration>
      </button>

      <button ng-show="timefilter.isTimeRangeSelectorEnabled" class="kuiLocalMenuItem ng-hide" ng-click="forward()" aria-label="Move forward in time">
        <span aria-hidden="true" class="kuiIcon fa-chevron-right" tooltip="Move forward in time"></span>
      </button>
    </div>
          </div>
        </div>
      </div>

      <!-- Dropdown content, e.g. time-picker. -->
      <div class="kuiLocalDropdown ng-hide" ng-show="kbnTopNav.rendered">
        <button class="kuiLocalDropdownCloseButton" ng-click="kbnTopNav.close()" aria-label="Close">
          <span class="kuiIcon fa-chevron-circle-up"></span>
        </button>
        <div id="template_wrapper">
          <!-- Content gets dynamically inserted here. -->
        </div>
      </div>

      <div class="kuiLocalNavRow kuiLocalNavRow--secondary">
        <!-- Bottom row slot, e.g. tabs. -->
        <div data-transclude-slot="bottomRow" class="kuiLocalTabs">
            <h2 ng-repeat="item in topNavMenu" class="kuiLocalTab">
              {{::item.key}}
            </h2>
          </div>
      </div>
    </div>
  </kbn-top-nav>


  <div class="row container">

    <div class="col-12-sm">

      <form class="form-group" id="import_form">
        <h2><small class="text-muted">{{ 'PLUGIN_DESCRIPTION' | translate }}</small></h2>
        </br>
        <input import-sheet-js class="form-control-file" type="file" id="file"><br/>
      </form>

      <div ng-show="showSheetForm">
        <form class="form-inline" id="sheet_form">
          <label>{{ 'CHOOSE_SHEETNAME_LABEL' | translate }}
            <select class="form-control" ng-model="sheetname" ng-options="item for item in sheetnames"></select>
            <button class="btn btn-primary btn-metriks" type="button" ng-click="convert()">{{ 'CONVERT_BUTTON' | translate }}</button>
          </label>
        </form>
      </div>

      <div id="message"></div>
      <div id="react_tabs"></div>

      <div ng-show="showUploadOptions">
        <div class="form-group row">
          <div class="form-group col-md-2 nopadding">
            <label>{{'INDEX_NAME_LABEL' | translate }}</label>
            <input type="text" class="form-control" ng-model="indexName" id="indexName"/>
          </div>
        </div>
        <div class="form-group row">
          <div class="form-group col-md-4 nopadding">
            <label>{{'ES_ID_LABEL' | translate }}</label>
            <input type="text" placeholder="Use placeholder {fieldname} to generate the ID" class="form-control" ng-model="esID" id="esID" ng-change="previewDocID()"/>
          </div>
          <div class="form-group col-md-4 nopadding">
            <label>{{ 'ES_PREVIEW_ID_LABEL' | translate }}</label>
            <input type="text" class="form-control" ng-readonly="true" ng-model="previewID"/>
          </div>
        </div>
        <div class="form-group">
          <button class="btn btn-primary btn-metriks" type="button" ng-click="transfer()">{{ 'SEND_BUTTON' | translate }}</button>
        </div>
      </div>
      <span us-spinner="{radius:30, width:8, length: 16}" spinner-on="showSpinner"></span>

    </div>
  </div>

</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.11.18/shim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.11.18/xlsx.core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.11.18/xlsx.full.min.js"></script>
